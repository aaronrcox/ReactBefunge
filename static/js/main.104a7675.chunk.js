(this.webpackJsonpReactBefunge=this.webpackJsonpReactBefunge||[]).push([[0],{43:function(e,t,n){e.exports=n(56)},48:function(e,t,n){},49:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var r=n(0),l=n.n(r),a=n(18),o=n.n(a),c=(n(48),n(49),n(4)),i=n(16),u=n(58),d=n(2),s="[TextGrid] NO Op",f="[TextGrid] Setup",x="[TextGrid] Initialise",v="[TextGrid] MouseMoved",p="[TextGrid] Mouse Pressed",h="[TextGrid] Mouse Released",g="[TextGrid] Scroll View",w="[TextGrid] Drag Start",I="[TextGrid] Drag End",y="[TextGrid] Key Down",O="[TextGrid] Set Hover Cell",b="[TextGrid] Set Cell Text",j="[TextGrid] Set Target Cell",m="[TextGrid] Shift Cells In Range",E="[TextGrid] Insert Row",M="[TextGrid] Insert Col",C="[TextGrid] Delete Row",R="[TextGrid] Delete Col",D="[TextGrid] Set Insert Mode",T="[TextGrid] Set Selection Area";function S(e){return{type:b,payload:e}}function G(e){return{type:j,payload:e}}function k(e){return{type:D,payload:{insertMode:e}}}function H(e){return{type:T,payload:e}}function W(e,t){return{type:M,payload:{rowIndex:e,colIndex:t}}}function N(e,t){return{type:R,payload:{rowIndex:e,colIndex:t}}}var A={cellWidth:24,cellHeight:24,rows:0,cols:0,cells:[],insertMode:!0,viewport:{rows:0,cols:0,xOffset:0,yOffset:0},hover:{rowIndex:-1,colIndex:-1,cellIndex:-1},target:{rowIndex:-1,colIndex:-1,cellIndex:-1},selection:{isMouseDown:!1,isDragging:!1,startRowIndex:0,startColIndex:0,endRowIndex:0,endColIndex:0},selectedCells:[]};var B=n(41),X=n(59),Y=n(39),K=Object(X.a)((function(e,t){return e.pipe(Object(B.a)(f),Object(Y.a)((function(e){console.log(e);var n,r=e.payload.width,l=e.payload.height,a=e.payload.text,o=e.payload.cellWidth||t.value.cellWidth,c=e.payload.cellHeight||t.value.cellHeight,i=Math.floor(l/(c-1))+1,u=Math.floor(r/(o-1))+1,s=Object(d.a)({},t.value.viewport,{rows:i,cols:u}),f=a.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/).map((function(e){return e.split("")}));return[(n={cellWidth:o,cellHeight:c,rows:i,cols:u,cells:f,viewport:s},{type:x,payload:n})]})))}),(function(e,t){return e.pipe(Object(B.a)(v),Object(Y.a)((function(e){var n=e.payload.mouseX,r=e.payload.mouseY,l=t.value.cellWidth-1,a=t.value.cellHeight-1,o=t.value.viewport,c=Math.floor(r/a)+o.yOffset,i=Math.floor(n/l)+o.xOffset,u=c*t.value.cols+i,s={rowIndex:c,colIndex:i,cellIndex:u},f=[];if(u!==t.value.hover.cellIndex&&f.push({type:O,payload:s}),t.value.selection.isMouseDown)if(t.value.selection.isDragging){var x=Object(d.a)({},t.value.selection);x.endRowIndex=c,x.endColIndex=i+(x.endColIndex<x.startColIndex?0:1),f.push(H(x))}else f.push({type:w});return f})))}),(function(e,t){return e.pipe(Object(B.a)(p),Object(Y.a)((function(e){return[G(J(t.value,t.value.hover,0,0))]})))}),(function(e,t){return e.pipe(Object(B.a)(h),Object(Y.a)((function(e){return[]})))}),(function(e,t){return e.pipe(Object(B.a)(y),Object(Y.a)((function(e){var n,r,l,a,o,c,i=e.payload.key,u=t.value.target.rowIndex,f=t.value.target.colIndex,x=t.value.insertMode,v=e.payload.isShiftDown,p=Object(d.a)({},t.value.selection);if(1===i.length){var h=J(t.value,t.value.target,1,0);return[x?W(u,f):{type:s},S({rowIndex:u,colIndex:f,value:i}),G(h)]}if("Tab"===i){var g=v?-1:1;return[G(J(t.value,t.value.target,g,0))]}if("Enter"===i)return[G(J(t.value,t.value.target,0,1))];if("Backspace"===i){var w=J(t.value,t.value.target,-1,0);return[x?N(w.rowIndex,w.colIndex):S({rowIndex:u,colIndex:f,value:""}),G(w)]}return"Delete"===i?[x?(n=f,r=u,l=f,a=u,o=-1,c=0,{type:m,payload:{startColIndex:n,startRowIndex:r,endColIndex:l,endRowIndex:a,dx:o,dy:c}}):S({rowIndex:u,colIndex:f,value:""})]:"ArrowLeft"===i?v?(p.endColIndex-=1,[H(p)]):[G(J(t.value,t.value.target,-1,0))]:"ArrowRight"===i?v?(p.endColIndex+=1,[H(p)]):[G(J(t.value,t.value.target,1,0))]:"ArrowUp"===i?v?(p.endRowIndex-=1,[H(p)]):[G(J(t.value,t.value.target,0,-1))]:"ArrowDown"===i?v?(p.endRowIndex+=1,[H(p)]):[G(J(t.value,t.value.target,0,1))]:"Insert"===i?[k(!t.value.insertMode)]:[]})))}));function J(e,t,n,r){var l=e.cols,a=t.rowIndex+r,o=t.colIndex+n;return{rowIndex:a=Math.max(a,0),colIndex:o=Math.max(o,0),cellIndex:a*l+o}}var L=Object(u.a)(),U=Object(i.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(d.a)({},e,{},t.payload);case O:return Object(d.a)({},e,{hover:t.payload});case b:var n=t.payload.rowIndex,r=t.payload.colIndex,l=t.payload.value,a=e.cells;return function(e,t,n){for(;e.length<=n;)e.push([]);for(;e[n].length<=t;)e.push("")}(a,r,n),a[n][r]=l,Object(d.a)({},e,{cells:a});case j:var o=Object(d.a)({},e.target,{},t.payload),c=Object(d.a)({},e.selection,{startRowIndex:o.rowIndex,startColIndex:o.colIndex,endRowIndex:o.rowIndex,endColIndex:o.colIndex});return Object(d.a)({},e,{target:o,selection:c});case D:return Object(d.a)({},e,{insertMode:t.payload.insertMode});case m:var i=t.payload,u=i.startColIndex,s=i.startRowIndex,f=(i.endColIndex,i.endRowIndex),v=i.dx,y=(i.dy,e.cells);return v<0&&function(e,t,n,r,l){for(var a=0;a<l;a++){for(var o=t;o<=n;o++)r[o].splice(e,1),r[o].push("");e-=1}}(u,s,f,y,Math.abs(v)),v>0&&function(e,t,n,r,l){for(var a=0;a<l;a++){for(var o=t;o<=n;o++)r[o]&&(r[o].pop(),r[o].splice(e,0,[""]));e+=1}}(u,s,f,y,Math.abs(v)),Object(d.a)({},e,{cells:y});case E:var S=t.payload.rowIndex,G=e.cells;return G.splice(S,0,[]),Object(d.a)({},e,{cells:G});case M:for(var k=t.payload,H=k.rowIndex,W=k.colIndex,N=e.cells;N.length<=H;)N.push([]);for(;N[H].length<=W;)N[H].push("");return N[H].splice(W,0,""),Object(d.a)({},e,{cells:N});case C:var B=t.payload.rowIndex,X=e.cells;return X.splice(B,1),Object(d.a)({},e,{cells:X});case R:console.log(R);var Y=t.payload,K=Y.rowIndex,J=Y.colIndex,L=e.cells;return L.length<=K?e:L[K].length<=J?e:(L[K].splice(J,1),Object(d.a)({},e,{cells:L}));case T:var U=Object(d.a)({},e.selection,{},t.payload),q=Object(d.a)({},e.target,{rowIndex:U.endRowIndex,colIndex:U.endColIndex,cellIndex:U.endRowIndex*e.cols+U.endColIndex});return Object(d.a)({},e,{selection:U,target:q});case p:var z=Object(d.a)({},e.selection,{isMouseDown:!0});return Object(d.a)({},e,{selection:z});case h:var P=Object(d.a)({},e.selection,{isMouseDown:!1});return Object(d.a)({},e,{selection:P});case g:var V=t.payload,$=V.xOffset,F=V.yOffset,Q=Object(d.a)({},e.viewport,{xOffset:Math.floor($/e.cellWidth),yOffset:Math.floor(F/e.cellHeight)});return Object(d.a)({},e,{viewport:Q});case w:var Z=Object(d.a)({},e.target),_=Object(d.a)({},e.selection,{isDragging:!0});return _.startColIndex=Z.colIndex,_.startRowIndex=Z.rowIndex,_.endColIndex=Z.colIndex,_.endRowIndex=Z.rowIndex+1,Object(d.a)({},e,{selection:_});case I:var ee=Object(d.a)({},e.selection,{isDragging:!1});return Object(d.a)({},e,{selection:ee});default:return e}}),Object(i.a)(L));L.run(K);var q=n(40),z=n(33);n(55);function P(e){var t=e.rowId,n=Object(c.c)((function(e){return e.cellHeight})),r=Object(c.c)((function(e){return e.viewport})),a=Object(c.c)((function(e){return e.cols})),o=r.cols>0?new Array(r.cols).fill(""):[];return l.a.createElement("div",{className:"text-grid-row",style:{height:n,maxHeight:n,minHeight:n}},o.map((function(e,n){var o=n+r.xOffset,c=t*a+o;return l.a.createElement(V,{key:"cell-"+o,rowId:t,colId:o,cellId:c})})))}function V(e){var t=e.rowId,n=e.colId,r=e.cellId,a=Object(c.c)((function(e){return t<e.cells.length&&n<e.cells[t].length?e.cells[t][n]:""})),o=Object(c.c)((function(e){return e.cellWidth})),i=Object(c.c)((function(e){return e.hover.rowIndex===t})),u=Object(c.c)((function(e){return e.hover.colIndex===n})),d=Object(c.c)((function(e){return e.target.cellIndex===r})),s=Object(c.c)((function(e){return e.insertMode})),f=i&&u;return l.a.createElement("span",{className:function(){var e=["text-grid-cell"];return f&&e.push("cell-hover"),i&&e.push("row-hover"),u&&e.push("col-hover"),d&&s&&e.push("active-insert"),d&&!s&&e.push("active-override"),e.join(" ")}(),style:{width:o,maxWidth:o,minWidth:o}},a)}function $(){var e=Object(c.c)((function(e){return e.selection})),t=Object(c.c)((function(e){return e.cellWidth})),n=Object(c.c)((function(e){return e.cellHeight})),r=Object(c.c)((function(e){return e.viewport})),a=e.startColIndex-r.xOffset,o=e.endColIndex-r.xOffset,i=e.startRowIndex-r.yOffset,u=e.endRowIndex-r.yOffset,d=(o-a)*(t-1),s=(u-i+1)*(n-1)+(u-i<0?-(n-1):0),f=a*(t-1)+Math.min(d,0),x=i*(n-1)+Math.min(s,0),v={width:Math.abs(d),height:Math.abs(s),left:f,top:x};return l.a.createElement("div",{className:"text-grid-selection",style:v})}function F(){var e=Object(c.c)((function(e){return e.viewport})),t=Object(c.c)((function(e){return e.target})),n=Object(c.c)((function(e){return e.cells}));return l.a.createElement("div",{className:"text-grid-status-bar"},l.a.createElement("ul",null,l.a.createElement("li",null,"R: ",e.rows),l.a.createElement("li",null,"C: ",e.cols),l.a.createElement("li",null,"SX: ",e.xOffset),l.a.createElement("li",null,"SY: ",e.yOffset),l.a.createElement("li",null,"TX: ",t.colIndex),l.a.createElement("li",null,"TY: ",t.rowIndex),l.a.createElement("li",null,"NumRows: ",n.length),l.a.createElement("li",null,"NumCols: ",n[t.rowIndex]?n[t.rowIndex].length:"")))}function Q(){var e=Object(r.useState)(1),t=Object(z.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(),c=Object(z.a)(o,2),i=c[0],u=c[1];Object(r.useEffect)((function(){f(),x()}),[]);var d={clear:function(e){f()},echo:function(e){s(e.join(" "))}},s=function(e){u(i+"\n "+e),i+="\n"+e},f=function(){u(""),i=""},x=function(){!function(e){var t=e.split(" ");if(0!==t.length){var n=Object(q.a)(t),r=n[0],l=n.slice(1);void 0!==d[r]&&d[r](l)}}(i.substr(n)),u(i+"\n> "),a((i+="\n> ").length)};return l.a.createElement("div",{className:"text-grid-console",style:{height:200,display:"flex"}},l.a.createElement("textarea",{wrap:"off",spellCheck:"false",value:i,onChange:function(e){u(e.target.value)},onKeyDown:function(e){1===e.key.length||("Enter"===e.key?(x(),e.preventDefault()):"Backspace"===e.key?e.target.selectionStart<=n&&e.preventDefault():"Delete"===e.key&&e.target.selectionStart<n&&e.preventDefault())},onSelect:function(e){e.target.selectionStart===n-1?e.target.setSelectionRange(n,n):e.target.selectionStart<n-1&&e.target.setSelectionRange(e.target.value.length,e.target.value.length)}}))}var Z=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.viewport})),a=n.rows>0?new Array(n.rows).fill(""):[],o=Object(r.useRef)(null);return Object(r.useEffect)((function(){var n=o.current?o.current.offsetWidth:0,r=o.current?o.current.offsetHeight:0;t(function(e,t,n,r,l){return{type:f,payload:{width:e,height:t,text:n,cellWidth:r,cellHeight:l}}}(n,r,e.text,e.tw,e.th))}),[e,t]),l.a.createElement("div",{ref:o,className:"text-grid-area",onScroll:function(e){var n,r;e.preventDefault(),t((n=e.target.scrollLeft,r=e.target.scrollTop,{type:g,payload:{xOffset:n,yOffset:r}}))},draggable:!0,tabIndex:"0",onKeyDown:function(e){var n;e.preventDefault(),t((n={key:e.key,isShiftDown:e.shiftKey},{type:y,payload:n}))},onMouseMove:function(e){var n=e.currentTarget.getBoundingClientRect(),r=e.clientX-n.left,l=e.clientY-n.top;t({type:v,payload:{mouseX:r,mouseY:l}})},onMouseUp:function(e){e.preventDefault(),t({type:h})},onMouseDown:function(e){e.preventDefault(),e.currentTarget.focus(),t({type:p})}},l.a.createElement("div",{className:"text-grid"},a.map((function(e,t){return l.a.createElement(P,{key:"gridRow-".concat(t),rowId:t+n.yOffset})})),l.a.createElement($,null)),l.a.createElement("div",{style:{width:1e4,height:1e4,position:"absolute"}}))};function _(e){return l.a.createElement(c.a,{store:U},l.a.createElement("div",{className:"text-grid-container",style:{display:"flex",flexDirection:"column",height:"100%"}},l.a.createElement(Z,e),l.a.createElement(Q,null),l.a.createElement(F,null)))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement((function(){return l.a.createElement("div",{className:"App"},l.a.createElement("div",{style:{width:"calc(100%)",height:"calc(100% )",overflow:"hidden"}},l.a.createElement(_,{tw:32,th:32,text:"\nHello world,\nthe quick brown fox \njumps over\nthe lazy \ndog\n"})))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[43,1,2]]]);
//# sourceMappingURL=main.104a7675.chunk.js.map